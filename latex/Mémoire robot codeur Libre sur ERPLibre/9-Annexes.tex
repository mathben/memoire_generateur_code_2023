%%
%%  Annexes
%%
%%  Note: Ne pas modifier la ligne ci-dessous. / Do not modify the following line.
\ifthenelse{\equal{\Langue}{english}}{
	\addcontentsline{toc}{compteur}{APPENDICES}
}{
	\addcontentsline{toc}{compteur}{ANNEXES}
}
%%
%%
%%  Toutes les annexes doivent être inclues dans ce document
%%  les unes à la suite des autres.
%%  All annexes must be included in this document one after the other.
% \Annexe{Démo}
% Texte de l'annexe B\@. Remarquez que la phrase précédente se termine
% par une lettre majuscule suivie d'un point. On indique explicitement
% cette situation à \LaTeX{} afin que ce dernier ajuste correctement
% l'espacement entre le point final de la phrase et le début de la
% phrase suivante.
% une autre page!


% \begin{landscape}
% \Annexe{Encore une annexe / Another Appendix}
% Texte de l'annexe B\@ en mode «landscape».
% \end{landscape}

% \Annexe{Une dernière annexe / The Last Appendix}
% Texte de l'annexe C\@.

\Annexe{GUI générateur de code - les modèles} \label{annexe_cg_gui_model}

\begin{figure}[htb]
\centering
\includegraphics[width=\textwidth]{cg_model.png}
\end{figure}

\Annexe{GUI générateur de code - les champs} \label{annexe_cg_gui_champs}

\begin{figure}[htb]
\centering
\includegraphics[width=\textwidth]{cg_champs.png}
\end{figure}

\Annexe{GUI générateur de code - les codes} \label{annexe_cg_gui_code}

\begin{figure}[htb]
\centering
\includegraphics[width=\textwidth]{cg_code.png}
\end{figure}

\Annexe{GUI générateur de code - les «hooks»} \label{annexe_cg_gui_hook}

\begin{figure}[htb]
\centering
\includegraphics[height=7in]{cg_hook.png}
\end{figure}


\Annexe{Test couverture technique générateur de code} \label{annexe_test_generateur_code}

\begin{table}[htb]
\centering
\begin{tabular}{|l|l|l|l|l|l|}

\hline
\cellcolor[HTML]{d9d9d9}{\textbf{Technique}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{base}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\textbf{\# instruction}}} & \cellcolor[HTML]{d9d9d9}{5 085}\\\hline

\multicolumn{2}{|l|}{\cellcolor[HTML]{efefef}{\textbf{Description du test}}} & \cellcolor[HTML]{efefef}{\textbf{Status}} & \cellcolor[HTML]{efefef}{\textbf{Durée (s)}} & \cellcolor[HTML]{efefef}{\textbf{\# de Miss}} & \cellcolor[HTML]{efefef}{\textbf{Cover (\%)}}\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^B$ modèle simple}} & Succès & 27 & 2 983 & 41\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^B$ modèle simple avec \\ héritage}} & Succès & 26 & 3 452 & 32\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Exportation µ$_C^B$ données «helpdesk»}} & Succès & 28 & 3 900 & 23\\\hline

% \end{tabular}
% \end{table}
% \begin{table}
% \centering
% \begin{tabular}{|l|l|l|l|l|l|}
% \hline

\cellcolor[HTML]{d9d9d9}{\textbf{Technique}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{base + hook}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\textbf{\# instruction}}} & \cellcolor[HTML]{d9d9d9}{5 985}\\\hline

\multicolumn{2}{|l|}{\cellcolor[HTML]{efefef}{\textbf{Description du test}}} & \cellcolor[HTML]{efefef}{\textbf{Status}} & \cellcolor[HTML]{efefef}{\textbf{Durée (s)}} & \cellcolor[HTML]{efefef}{\textbf{\# de Miss}} & \cellcolor[HTML]{efefef}{\textbf{Cover (\%)}}\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Auto-génération µ$_C^0$}} & Succès & 17 & 4 683 & 22\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Nouveau projet µ$_C^0$ µ$_C^A$ µ$_C^B$ \\ «Hello World»}} & Succès & 39 & 4 610 & 23\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^A$ portail}} & Succès & 44 & 3 638 & 39\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^A$ modèle simple}} & Succès & 33 & 3 982 & 33\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^A$ modèle simple avec \\ héritage}} & Succès & 32 & 4 027 & 33\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Exportation µ$_C^B$ données «website»}} & Succès & 28 & 3 900 & 23\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^B$ du générateur de \\ code}} & Échec & 20 & 3 529 & 41\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^A$ du générateur de \\ code}} & Échec & 29 & 3 690 & 38\\\hline

% \end{tabular}
% \end{table}
% \begin{table}
% \centering
% \begin{tabular}{|l|l|l|l|l|l|}
% \hline

\cellcolor[HTML]{d9d9d9}{\textbf{Technique}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{base + cron}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\textbf{\# instruction}}} & \cellcolor[HTML]{d9d9d9}{6 153}\\\hline

\multicolumn{2}{|l|}{\cellcolor[HTML]{efefef}{\textbf{Description du test}}} & \cellcolor[HTML]{efefef}{\textbf{Status}} & \cellcolor[HTML]{efefef}{\textbf{Durée (s)}} & \cellcolor[HTML]{efefef}{\textbf{\# de Miss}} & \cellcolor[HTML]{efefef}{\textbf{Cover (\%)}}\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^A$ «auto\_backup»}} & Succès & 36 & 3 422 & 44\\\hline

% \end{tabular}
% \end{table}
% \begin{table}
% \centering
% \begin{tabular}{|l|l|l|l|l|l|}
% \hline

\cellcolor[HTML]{d9d9d9}{\textbf{Technique}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{base + portal}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\textbf{\# instruction}}} & \cellcolor[HTML]{d9d9d9}{5 799}\\\hline

\multicolumn{2}{|l|}{\cellcolor[HTML]{efefef}{\textbf{Description du test}}} & \cellcolor[HTML]{efefef}{\textbf{Status}} & \cellcolor[HTML]{efefef}{\textbf{Durée (s)}} & \cellcolor[HTML]{efefef}{\textbf{\# de Miss}} & \cellcolor[HTML]{efefef}{\textbf{Cover (\%)}}\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^B$ exemple MariaDB \\ \texttt{SQL}}} & Succès & 80 & 3 104 & 46\\\hline

% \end{tabular}
% \end{table}
% \begin{table}
% \centering
% \begin{tabular}{|l|l|l|l|l|l|}
% \hline

\cellcolor[HTML]{d9d9d9}{\textbf{Technique}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{base + «theme\_website»}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\textbf{\# instruction}}} & \cellcolor[HTML]{d9d9d9}{5 336}\\\hline

\multicolumn{2}{|l|}{\cellcolor[HTML]{efefef}{\textbf{Description du test}}} & \cellcolor[HTML]{efefef}{\textbf{Status}} & \cellcolor[HTML]{efefef}{\textbf{Durée (s)}} & \cellcolor[HTML]{efefef}{\textbf{\# de Miss}} & \cellcolor[HTML]{efefef}{\textbf{Cover (\%)}}\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^B$ thème «website»}} & Succès & 27 & 3 938 & 26\\\hline

% \end{tabular}
% \end{table}
% \begin{table}
% \centering
% \begin{tabular}{|l|l|l|l|l|l|}
% \hline

\cellcolor[HTML]{d9d9d9}{\textbf{Technique}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{base + «website\_snippet»}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\textbf{\# instruction}}} & \cellcolor[HTML]{d9d9d9}{5 615}\\\hline

\multicolumn{2}{|l|}{\cellcolor[HTML]{efefef}{\textbf{Description du test}}} & \cellcolor[HTML]{efefef}{\textbf{Status}} & \cellcolor[HTML]{efefef}{\textbf{Durée (s)}} & \cellcolor[HTML]{efefef}{\textbf{\# de Miss}} & \cellcolor[HTML]{efefef}{\textbf{Cover (\%)}}\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^B$ individuel \\ «website\_snippet»}} & Succès & 26 & 4 284 & 24\\\hline

\end{tabular}
\end{table}
\begin{table}[htb]
\centering
\begin{tabular}{|l|l|l|l|l|l|}
\hline

\cellcolor[HTML]{d9d9d9}{\textbf{Technique}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\shortstack[l]{base + portal + \\ «website\_snippet»}}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\textbf{\# instruction}}} & \cellcolor[HTML]{d9d9d9}{6 329}\\\hline

\multicolumn{2}{|l|}{\cellcolor[HTML]{efefef}{\textbf{Description du test}}} & \cellcolor[HTML]{efefef}{\textbf{Status}} & \cellcolor[HTML]{efefef}{\textbf{Durée (s)}} & \cellcolor[HTML]{efefef}{\textbf{\# de Miss}} & \cellcolor[HTML]{efefef}{\textbf{Cover (\%)}}\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^B$ multiple \\ «website\_snippet»}} & Succès & 36 & 2 898 & 54\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^B$ portail}} & Succès & 34 & 3 173 & 50\\\hline

% \end{tabular}
% \end{table}
% \begin{table}
% \centering
% \begin{tabular}{|l|l|l|l|l|l|}
% \hline

\cellcolor[HTML]{d9d9d9}{\textbf{Technique}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{base + portal + «Migration DB»}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\textbf{\# instruction}}} & \cellcolor[HTML]{d9d9d9}{6 559}\\\hline

\multicolumn{2}{|l|}{\cellcolor[HTML]{efefef}{\textbf{Description du test}}} & \cellcolor[HTML]{efefef}{\textbf{Status}} & \cellcolor[HTML]{efefef}{\textbf{Durée (s)}} & \cellcolor[HTML]{efefef}{\textbf{\# de Miss}} & \cellcolor[HTML]{efefef}{\textbf{Cover (\%)}}\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération migration MariaDB \\ \texttt{SQL}}} & Succès & 121 & 3 267 & 50\\\hline

% \end{tabular}
% \end{table}
% \begin{table}
% \centering
% \begin{tabular}{|l|l|l|l|l|l|}

\hline
\cellcolor[HTML]{d9d9d9}{\textbf{Technique}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{base + hook + portal}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\textbf{\# instruction}}} & \cellcolor[HTML]{d9d9d9}{6 699}\\\hline

\multicolumn{2}{|l|}{\cellcolor[HTML]{efefef}{\textbf{Description du test}}} & \cellcolor[HTML]{efefef}{\textbf{Status}} & \cellcolor[HTML]{efefef}{\textbf{Durée (s)}} & \cellcolor[HTML]{efefef}{\textbf{\# de Miss}} & \cellcolor[HTML]{efefef}{\textbf{Cover (\%)}}\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^A$ MariaDB \texttt{SQL}}} & Succès & 78 & 4 315 & 36\\\hline

% \end{tabular}
% \end{table}
% \begin{table}
% \centering
% \begin{tabular}{|l|l|l|l|l|l|}
% \hline

\cellcolor[HTML]{d9d9d9}{\textbf{Technique}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{base + hook + cron}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\textbf{\# instruction}}} & \cellcolor[HTML]{d9d9d9}{6 153}\\\hline

\multicolumn{2}{|l|}{\cellcolor[HTML]{efefef}{\textbf{Description du test}}} & \cellcolor[HTML]{efefef}{\textbf{Status}} & \cellcolor[HTML]{efefef}{\textbf{Durée (s)}} & \cellcolor[HTML]{efefef}{\textbf{\# de Miss}} & \cellcolor[HTML]{efefef}{\textbf{Cover (\%)}}\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^A$ «auto\_backup»}} & Succès & 36 & 3 422 & 44\\\hline

% \end{tabular}
% \end{table}
% \begin{table}
% \centering
% \begin{tabular}{|l|l|l|l|l|l|}
% \hline

\cellcolor[HTML]{d9d9d9}{\textbf{Technique}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\shortstack[l]{base + geoengine + \\ «website\_leaflet»}}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\textbf{\# instruction}}} & \cellcolor[HTML]{d9d9d9}{5 423}\\\hline

\multicolumn{2}{|l|}{\cellcolor[HTML]{efefef}{\textbf{Description du test}}} & \cellcolor[HTML]{efefef}{\textbf{Status}} & \cellcolor[HTML]{efefef}{\textbf{Durée (s)}} & \cellcolor[HTML]{efefef}{\textbf{\# de Miss}} & \cellcolor[HTML]{efefef}{\textbf{Cover (\%)}}\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Génération µ$_C^B$ \\ «website\_snippet\_leaflet»}} & Succès & 33 & 3 259 & 40\\\hline

% \end{tabular}
% \end{table}
% \begin{table}
% \centering
% \begin{tabular}{|l|l|l|l|l|l|}
% \hline

\cellcolor[HTML]{d9d9d9}{\textbf{Technique}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\shortstack[l]{base + cron + hook + \\ «Migration DB» + geoengine + \\ portal + «theme\_website» + \\ «website\_snippet» + \\ «website\_leaflet»}}} & \multicolumn{2}{|l|}{\cellcolor[HTML]{d9d9d9}{\textbf{\# instruction}}} & \cellcolor[HTML]{d9d9d9}{8 746}\\\hline

\multicolumn{2}{|l|}{\cellcolor[HTML]{efefef}{\textbf{Description du test}}} & \cellcolor[HTML]{efefef}{\textbf{Status}} & \cellcolor[HTML]{efefef}{\textbf{Durée (s)}} & \cellcolor[HTML]{efefef}{\textbf{\# de Miss}} & \cellcolor[HTML]{efefef}{\textbf{Cover (\%)}}\\\hline

\multicolumn{2}{|l|}{\shortstack[l]{Tous les tests à succès}} & Succès & 194 & 1 371 & 84\\\hline

\end{tabular}
\end{table}

\Annexe{Diagramme modèle de données Espace Membre Accorderie 2019} \label{annexe_db_accorderie_2019}

\begin{figure}[htb]
\centering
\includegraphics[height=7in]{schema_bd_accorderie.png}
\end{figure}

\Annexe{Diagramme nouveau modèle de données Espace Membre Accorderie 2023} \label{annexe_db_accorderie_2023}

\begin{figure}[htb]
\centering
\includegraphics[width=\textwidth]{schema_bd_accorderie_new_small.png}
\end{figure}

\Annexe{Diagramme processus pour demander, offrir, établir un échange et le valider - Accorderie 2023} \label{annexe_processus_accorderie_2023}

\begin{figure}[htb]
\centering
\includegraphics[width=\textwidth]{accorderie_processus.png}
\end{figure}

\Annexe{Diagramme modèle de données du portail CEPPP septembre 2022} \label{annexe_db_ceppp_2022}

\begin{figure}[htb]
\centering
\includegraphics[width=\textwidth]{schema_bd_ceppp_suite_crm_small.png}
\end{figure}

\Annexe{Vue formulaire administration portail CEPPP} \label{annexe_form_ceppp_2022}

\begin{figure}[htb]
\centering
\includegraphics[height=7in]{exemple_vue_formulaire_patient_ceppp.png}
\end{figure}

\Annexe{Vue formulaire partenaire portail CEPPP} \label{annexe_form_anonyme_ceppp_2022}

\begin{figure}[htb]
\centering
\includegraphics[width=\textwidth]{exemple_vue_formulaire_patient_anonyme_ceppp.png}
\end{figure}

\Annexe{Code u$_C^0$ dans le générateur de code} \label{annexe_cg_code_uc0}

\begin{lstlisting}[language=Python, upquote=true]
import os

from odoo import SUPERUSER_ID, _, api, fields, models

# TODO HUMAN: change my module_name to create a specific demo functionality
MODULE_NAME = "code_generator_demo"


def post_init_hook(cr, e):
   with api.Environment.manage():
       env = api.Environment(cr, SUPERUSER_ID, {})

       # The path of the actual file
       # path_module_generate = os.path.normpath(os.path.join(os.path.dirname(__file__), '..'))

       short_name = MODULE_NAME.replace("_", " ").title()

       # Add code generator
       value = {
           "shortdesc": short_name,
           "name": MODULE_NAME,
           "license": "AGPL-3",
           "author": "TechnoLibre",
           "website": "https://technolibre.ca",
           "application": True,
           "enable_sync_code": True,
           # "path_sync_code": path_module_generate,
       }

       # TODO HUMAN: enable your functionality to generate
       value["enable_template_code_generator_demo"] = True
       value["template_model_name"] = ""
       value["template_inherit_model_name"] = ""
       # value["template_module_path_generated_extension"] = "."
       value["enable_template_wizard_view"] = False
       value["force_generic_template_wizard_view"] = False
       value["disable_generate_access"] = False
       value["enable_template_website_snippet_view"] = False
       value["enable_sync_template"] = False
       value["ignore_fields"] = ""
       value["post_init_hook_show"] = True
       value["uninstall_hook_show"] = True
       value["post_init_hook_feature_code_generator"] = True
       value["uninstall_hook_feature_code_generator"] = True

       new_module_name = MODULE_NAME
       if (
           MODULE_NAME != "code_generator_demo"
           and "code_generator_" in MODULE_NAME
       ):
           if "code_generator_template" in MODULE_NAME:
               if value["enable_template_code_generator_demo"]:
                   new_module_name = f"code_generator_{MODULE_NAME[len('code_generator_template_'):]}"
               else:
                   new_module_name = MODULE_NAME[
                       len("code_generator_template_") :
                   ]
           else:
               new_module_name = MODULE_NAME[len("code_generator_") :]
           value["template_module_name"] = new_module_name
       value["hook_constant_code"] = f'MODULE_NAME = "{new_module_name}"'

       code_generator_id = env["code.generator.module"].create(value)

       # Add dependencies
       lst_depend_module = ["code_generator", "code_generator_hook"]
       code_generator_id.add_module_dependency(lst_depend_module)
       code_generator_id.add_module_dependency_template(lst_depend_module)
       # Generate module
       value = {"code_generator_ids": code_generator_id.ids}
       env["code.generator.writer"].create(value)


def uninstall_hook(cr, e):
   with api.Environment.manage():
       env = api.Environment(cr, SUPERUSER_ID, {})
       code_generator_id = env["code.generator.module"].search(
           [("name", "=", MODULE_NAME)]
       )
       if code_generator_id:
           code_generator_id.unlink()
\end{lstlisting}